<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fakestore</title>
  <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.css" />
  <link rel="stylesheet" href="../node_modules/bootstrap-icons/font/bootstrap-icons.css" />
  <script src="../node_modules/bootstrap/dist/js/bootstrap.bundle.js"></script>
  <script>
    function LoadCategories() {
      fetch("https://fakestoreapi.com/products/categories")
        .then((response) => {
          if (!response.ok) throw new Error("Failed to load categories");
          return response.json();
        })
        .then((categories) => {
          categories.unshift("all");
          for (let category of categories) {
            let option = document.createElement("option");
            option.value = category;
            option.text = category.toUpperCase();
            document.getElementById("lstCategories").appendChild(option);
          }
        })
        .catch((err) => console.error("Error loading categories:", err));
    }

    function LoadProducts(url) {
      document.querySelector("main").innerHTML = "";
      fetch(url)
        .then((response) => {
          if (!response.ok) throw new Error("Failed to load products");
          return response.json();
        })
        .then((products) => {
          for (let product of products) {
            let card = document.createElement("div");
            card.className = "card m-2 p-2";
            card.style.width = "200px";
            card.innerHTML = `
              <img src="${product.image}" height="100" class="card-img-top">
              <div class="card-header overflow-auto" style="height:110px">
                ${product.title}
              </div>
              <div class="card-body">
                <dl>
                  <dt>Price</dt>
                  <dd>$${product.price}</dd>
                  <dt>Rating</dt>
                  <dd>${product.rating.rate} <span class="bi bi-star-fill text-success"></span></dd>
                </dl>
              </div>
              <div class="card-footer">
                <button class="btn btn-warning w-100 bi bi-cart4"> Add to Cart</button>
              </div>
            `;
            document.querySelector("main").appendChild(card);
          }
        })
        .catch((err) => console.error("Error loading products:", err));
    }

    function bodyload() {
      LoadCategories();
      LoadProducts("https://fakestoreapi.com/products");
    }

    function ChangeCategories() {
      let categoryName = document.getElementById("lstCategories").value;
      if (categoryName === "all") {
        LoadProducts("https://fakestoreapi.com/products");
      } else {
        LoadProducts(`https://fakestoreapi.com/products/category/${categoryName}`);
      }
    }
  </script>
</head>
<body class="container-fluid" onload="bodyload()">
  <header class="p-1 bg-secondary text-white">
    <div class="fs-1 fw-bold text-center">Fakestore - Online Shopping</div>
  </header>
  <section class="row mt-3">
    <nav class="col-2">
      <label class="form-label fw-bold">Select Category</label>
      <div>
        <select onchange="ChangeCategories()" class="form-select" id="lstCategories"></select>
      </div>
    </nav>
    <main class="col-10 d-flex flex-wrap overflow-auto" style="height: 450px;"></main>
  </section>
</body>
</html>
